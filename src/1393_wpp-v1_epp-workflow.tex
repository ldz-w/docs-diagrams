% Preamble
\documentclass[tikz,border=12pt,12pt]{standalone}
\input{style/sequence.tikz}
\input{vars/shortcuts.tex}

\begin{document}
\begin{tikzpicture}

% Body
  % Participants
  \node[pt2] at (-5,1.5) {Consumer};
  \node[icon] (icon1) at (-5,3)
       {\includegraphics[width=.1\textwidth]{useralt.png}};
       \node[pt1] at (5,2) {Payment Page \\ (Merchant Site)};
       \node[icon] (icon2) at (5,3)
            {\includegraphics[width=.1\textwidth]{paymentpage.png}};
            \node[pt3] at (15,2) {\wdpaymentgateway};
            \node[icon] (icon3) at (15,3)
                 {\includegraphics[width=.1\textwidth]{gear.png}};
                 \node[pt4] at (25,2) {Financial \\ Institution};
                 \node[icon] (icon4) at (25,3)
                      {\includegraphics[width=.1\textwidth]{issuing.png}};
                      
  			% Aid Lines
  			\draw[line_night] (-5,0) -- (-5,-10);
  			\draw[line_mulberry] (5,0) -- (5,-10);
  			\draw[line_nightsky] (15,0) -- (15,-10);
  			\draw[line_sky] (25,0) -- (25,-10);

                      % Nodes
                      \fill[night] (-5.1,-.75) rectangle (-4.9,-1.25);
                      \fill[mulberry] (5.1,-.9) rectangle (4.9,-1.6);
                      \fill[nightsky] (15.1,-1.4) rectangle (14.9,-3.1);
                      \fill[mulberry] (5.1,-2.9) rectangle (4.9,-4.6);
                      \fill[nightsky] (14.9,-4.4) rectangle (15.1,-5.1);
                      \fill[sky] (24.9,-4.9) rectangle (25.1,-6.6);
                      \fill[nightsky] (14.9,-6.4) rectangle (15.1,-7.1);
                      \fill[mulberry] (5.1,-6.9) rectangle (4.9,-9.1);
                      \fill[night] (-5.1,-8.75) rectangle (-4.9,-9.25);

                      % Arrows & Text
                      \draw[solidarrow]
                      	(-4.8,-1) -- node[midway,above] {1. } (4.8,-1);
                      \draw[solidarrow, txt]
                      	(5.2,-1.5) -- node[midway,above] {2. } (14.8,-1.5);
                      \draw[dashedarrow, txt]
                      	(14.8,-3) -- node[midway,above] {3. } (5.2,-3);
                      \draw[solidarrow, txt]
                     	 (5.2,-4.5) -- node[midway,above] {4. } (14.8,-4.5);
                      \draw[solidarrow, txt]
                      	(15.2,-5) -- node[midway,above] {5. } (24.8,-5);
                      \draw[dashedarrow, txt]
                      	(24.8,-6.5) -- node[midway,above] {5.1 } (15.2,-6.5);
                      \draw[dashedarrow, txt]
                      	(14.8,-7) -- node[midway,above] {6. } (5.2,-7);
                      \draw[dashedarrow, txt]
                      	(5.3,-7.5) -- (5.5,-7.5) -- node[midway,right] {7. } (5.5,-9) -- (5.3,-9);
                      \draw[dashedarrow, txt]
                      	(4.8,-9) -- node[midway,above] {8. } (-4.8,-9);

\end{tikzpicture}
\end{document}
