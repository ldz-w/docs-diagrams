% Document Header
\documentclass[tikz,border=12pt,12pt]{standalone}
\hyphenpenalty=10000
\input{style/cc-flow.tikz}
\input{vars/shortcuts.tex}

\usepackage{tikz}
\usetikzlibrary{shapes.multipart}
\usetikzlibrary{calc}

\begin{document}
\begin{tikzpicture} 

% Nodes
\node[name=int1,split3] (int1) {
    \nodepart  [white] {one} Initial Transaction \\ (Request)
    \nodepart [nightblue] {two} $<$transaction-type$>$:purchase
    \nodepart [nightblue] {three} $<$periodic-type$>$:recurring \\ $<$sequence-type$>$:first
  };
\node[name=int2, split, right of=int1] (int2) {
    \nodepart [white] {one} Initial Transaction \\ (Response)
    \nodepart [nightblue] {two} $<$transaction-id$>$:12345
  };
\node[name=rect1, split4, right of=int2] (rect1) {
    \nodepart [white] {one} Recurring Transaction \\ (Request)
    \nodepart [nightblue] {two} $<$transaction-type$>$: \\ referenced-purchase
    \nodepart [nightblue] {three} $<$parent-transaction-id$>$:12345
    \nodepart [nightblue] {four} $<$periodic-type$>$:recurring \\ $<$sequence-type$>$:recurring
  };
\node[name=rect2, split, right of=rect1] (rect2) {
    \nodepart [white] {one} Recurring Transaction \\ (Response)
    \nodepart [nightblue] {two} $<$transaction-id$>$:67890
  };
\node[name=fint1, split4, right of=rect2] (fint1) {
    \nodepart [white] {one} Final Transaction \\ (Request)
    \nodepart [nightblue] {two} $<$transaction-type$>$: \\ referenced-purchase
    \nodepart [nightblue] {three} $<$parent-transaction-id$>$:12345
    \nodepart [nightblue] {four} $<$periodic-type$>$:recurring \\ $<$sequence-type$>$:final
  };
\node[name=fint2, split, right of=fint1] (fint2) {
    \nodepart [white] {one} Final Transaction \\ (Response)
    \nodepart [nightblue] {two} $<$transaction-id$>$:45678
  };

% Lines
\draw[solidarrow] (int1.two east) -| (4.5,0) |- (int2.two west);
\draw[solidarrow] (int1.three east) -| (4.5,0) |- (int2.two west);

\draw[solidarrow] (int2.two east) -| (13.5,0) |- (rect1.two west);
\draw[solidarrow] (int2.two east) -- (rect1.three west);
\draw[solidarrow] (int2.two east) -| (13.5,0) |- (rect1.four west);

\draw[solidarrow] (rect1.two east) -| (22.5,0) |- (rect2.two west);
\draw[solidarrow] (rect1.three east) -- (rect2.two west);
\draw[solidarrow] (rect1.four east) -| (22.5,0) |- (rect2.two west);

\draw[solidarrow] (rect2.two east) -| (31.5,0) |- (fint1.two west);
\draw[solidarrow] (rect2.two east) -- (fint1.three west);
\draw[solidarrow] (rect2.two east) -| (31.5,0) |- (fint1.four west);

\draw[solidarrow] (fint1.two east) -| (40.5,0) |- (fint2.two west);
\draw[solidarrow] (fint1.three east) -- (fint2.two west);
\draw[solidarrow] (fint1.four east) -| (40.5,0) |- (fint2.two west);

% Document Footer
\end{tikzpicture}
\end{document}
